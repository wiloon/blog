---
author: "-"
date: "2020-09-06 00:21:46" 
title: "video, h.264, h.265, ffmpeg"

categories:
  - inbox
tags:
  - reprint
---
## "video, h.264, h.265, ffmpeg"
H.265与H.264是ITU-T VCEG 制定的视频编码标准。H.265标准围绕着现有的视频编码标准H.264，保留原来的某些技术，同时对一些相关的技术加以改进。新技术使用先进的技术用以改善码流、编码质量、延时和算法复杂度之间的关系，达到最优化设置。具体的研究内容包括: 提高压缩效率、提高鲁棒性和错误恢复能力、减少实时的时延、减少信道获取时间和随机接入时延、降低复杂度等。H264由于算法优化，可以低于1Mbps的速度实现标清数字图像传送；H265则可以实现利用1~2Mbps的传输速度传送720P (分辨率1280*720) 普通高清音视频传送。
H.265旨在在有限带宽下传输更高质量的网络视频，仅需H.264的一半带宽即可播放相同质量的视频。H.265标准也同时支持4K(4096×2160)和8K(8192×4320)超高清视频。
### H.264
H.264，同时也是MPEG-4第十部分，是由ITU-T视频编码专家组 (VCEG) 和ISO/IEC动态图像专家组 (MPEG) 联合组成的联合视频组 (JVT，Joint Video Team) 提出的高度压缩数字视频编解码器标准。这个标准通常被称之为H.264/AVC (或者AVC/H.264或者H.264/MPEG-4AVC或MPEG-4/H.264 AVC) 而明确的说明它两方面的开发者。

H.264最大的优势是具有很高的数据压缩比率，在同等图像质量的条件下，H.264的压缩比是MPEG-2的2倍以上，是MPEG-4的1.5～2倍。举个例子，原始文件的大小如果为88GB，采用MPEG-2压缩标准压缩后变成3.5GB，压缩比为25∶1，而采用H.264压缩标准压缩后变为879MB，从88GB到879MB，H.264的压缩比达到惊人的102∶1。低码率 (Low Bit Rate) 对H.264的高的压缩比起到了重要的作用，和MPEG-2和MPEG-4ASP等压缩技术相比，H.264压缩技术将大大节省用户的下载时间和数据流量收费。尤其值得一提的是，H.264在具有高压缩比的同时还拥有高质量流畅的图像，正因为如此，经过H.264压缩的视频数据，在网络传输过程中所需要的带宽更少，也更加经济。
### H.265, HEVC(高效视频编码)
H.265是ITU-TVCEG继H.264之后所制定的新的视频编码标准。H.265标准围绕着现有的视频编码标准H.264，保留原来的某些技术，同时对一些相关的技术加以改进。

新技术使用先进的技术用以改善码流、编码质量、延时和算法复杂度之间的关系，达到最优化设置。具体的研究内容包括: 提高压缩效率、提高鲁棒性和错误恢复能力、减少实时的时延、减少信道获取时间和随机接入时延、降低复杂度等。H264由于算法优化，可以低于1Mbps的速度实现标清数字图像传送；H265则可以实现利用1~2Mbps的传输速度传送720P (分辨率1280*720) 普通高清音视频传送。

H.265旨在在有限带宽下传输更高质量的网络视频，仅需原先的一半带宽即可播放相同质量的视频。这也意味着，我们的智能手机、平板机等移动设备将能够直接在线播放1080p的全高清视频。H.265标准也同时支持4K(4096×2160)和8K(8192×4320)超高清视频。可以说，H.265标准让网络视频跟上了显示屏"高分辨率化"的脚步。

### H.265与H.264有何不同

在讨论H.265有哪些提升和优点之前，我们不妨先来了解一下H.264。H.264也称作MPEG-4AVC(Advanced Video Coding，高级视频编码)，是一种视频压缩标准，同时也是一种被广泛使用的高精度视频的录制、压缩和发布格式。H.264因其是蓝光光盘的一种编解码标准而著名，所有蓝光播放器都必须能解码H.264。更重要的是，因为苹果公司当初毅然决然抛弃了Adobe的VP6编码，选择了H.264，这个标准也就随着数亿台iPad和iPhone走入了千家万户，成为了目前视频编码领域的绝对霸主，占有超过80%的份额。H.264也被广泛用于网络流媒体数据、各种高清晰度电视广播以及卫星电视广播等领域。H.264相较于以前的编码标准有着一些新特性，如多参考帧的运动补偿、变块尺寸运动补偿、帧内预测编码等，通过利用这些新特性，H.264比其他编码标准有着更高的视频质量和更低的码率，也因此受到了人们的认可，而被广泛应用。



H.265/HEVC的编码架构大致上和H.264/AVC的架构相似，也主要包含: 帧内预测(intra prediction)、帧间预测(inter prediction)、转换(transform)、量化(quantization)、去区块滤波器(deblocking filter)、熵编码(entropy coding)等模块。但在HEVC编码架构中，整体被分为了三个基本单位，分別是: 编码单位(coding unit，CU)、预测单位(predict unit，PU)和转换单位(transform unit，TU)。

四、H.265为何优于H.264

比起H.264/AVC，H.265/HEVC提供了更多不同的工具来降低码率，以编码单位来说， 最小的8x8到最大的64x64。信息量不多的区域(颜色变化不明显，比如车体的红色部分和地面的灰色部分)划分的宏块较大，编码后的码字较少，而细节多的地方(轮胎)划分的宏块就相应的小和多一些，编码后的码字较多，这样就相当于对图像进行了有重点的编码，从而降低了整体的码率，编码效率就相应提高了。同时，H.265的帧内预测模式支持33种方向(H.264只支持8种)，并且提供了更好的运动补偿处理和矢量预测方法。



反复的质量比较测试已经表明，在相同的图象质量下，相比于H.264，通过H.265编码的视频码流大小比H.264减少大约39-44%。由于质量控制的测定方法不同，这个数据也会有相应的变化。通过主观视觉测试得出的数据显示，在码率减少51-74%的情况下，H.265编码视频的质量还能与H.264编码视频近似甚至更好，其本质上说是比预期的信噪比(PSNR)要好。这些主观视觉测试的评判标准覆盖了许多学科，包括心理学和人眼视觉特性等，视频样本非常广泛，虽然它们不能作为最终结论，但这也是非常鼓舞人心的结果。

目前的HEVC标准共有三种模式: Main、Main10和Main Still Picture。Main模式支持8bit色深(即红绿蓝三色各有256个色度，共1670万色)，Main10模式支持10bit色深，将会用于超高清电视(UHDTV)上。前两者都将色度采样格式限制为4: 2: 0。预期将在2014年对标准有所扩展，将会支持4: 2: 2和4: 4: 4采样格式(即提供了更高的色彩还原度)和多视图编码(例如3D立体视频编码)。

事实上，H.265和H.264标准在各种功能上有一些重叠。例如，H.264标准中的Hi10P部分就支持10bit色深的视频。另一个，H.264的部分(Hi444PP)还可以支持4: 4: 4色度抽样和14比特色深。在这种情况下，H.265和H.264的区别就体现在前者可以使用更少的带宽来提供同样的功能，其代价就是设备计算能力: H.265编码的视频需要更多的计算能力来解码。目前已经有支持H.265解码的芯片发布了——美国博通公司(Broadcom)在今年1月初的CES大展上发布了一款Brahma BCM 7445芯片，它是一个采用28纳米工艺的四核处理器，可以同时转码四个1080P视频数据流或解析分辨率为4096×2160的H.265编码超高清视频。

H.265标准的诞生是在有限带宽下传输更高质量的网络视频。对于大多数专业人士来说，H.265编码标准并不陌生，其是ITU-TVCEG继H.264之后所制定的视频编码标准。H.265标准主要是围绕着现有的视频编码标准H.264，在保留了原有的某些技术外，增加了能够改善码流、编码质量、延时及算法复杂度之间的关系等相关的技术。H.265研究的主要内容包括，提高压缩效率、提高鲁棒性和错误恢复能力、减少实时的时延、减少信道获取时间和随机接入时延、降低复杂度。

### AVS+
AVS工作组于2006年推出了第一代视频编码标准AVS1，被颁布为中国国家标准。随后又推出了AVS1的增强版本AVS+，压缩效率和H.264/AVC的High Profile相当，并于2012年7月被国家电影电视总局颁布为广播电影电视行业标准，目前已有上千套AVS+的高清内容上星直播。AVS是在H.264的基础上发展起来的，吸收了H.264的精华，但为了绕过专利的困扰，又不得不放弃H.264的一些核心算法。换来的代价就是，编码效率稍微降低一点的情况下，复杂度极大得降低了。
### VP9
VP9 是Google提供的开源的免费视频codec，是VP8的后续版本，初始开发时命名为下一代开源视频或者VP-NEXT. VP9的开发始于2011年Q3，试图降低VP8的50%的码率而保持相同的质量，另外希望VP9比H.265 ( High Efficiency Video Coding) 有更好的编码效率。 2012年底，VP9的解码器被加入Chrome浏览器，2013年2月发布正式版本的chrome浏览器。VP9支持超宏块大小到32x32，也采用了四叉树的宏块分解结构。

### AV1
AV1 (Alliance for Open Media Video 1) 是由AOM (Alliance for Open Media，开放媒体联盟) 制定的一个开源、免版权费的视频编码格式，目标是解决H265昂贵的专利费用和复杂的专利授权问题并成为新一代领先的免版权费的编码标准。此外，AV1是google制定的VP9标准的继任者，也是H265强有力的竞争者。
AV1和HEVC/H.265之间很可能会是长期并存和竞争的关系，不管AV1在其它方面究竟会表现如何，但免费总是好的，另外还是那句话，视频标准的竞争技术不是唯一的，很有可能竞争的结果是HEVC/H.265就专注于企业级、私有云市场，而AV1将广泛应用于互联网上、公有云上。

AV1和VP9之间，应该不太存在竞争，而是直接替代的方式。因为AV1的核心代码都来自VP10

https://my.oschina.net/u/1018779/blog/139167

### 1080p
P是逐行扫描，几P就是纵向有多少行像素，例如，1080p就是纵向有1080行像素，逐行扫描 (其实现在的视频已经没有"扫描"这个概念了，扫描是从摄影机和模拟电视延续下来的一个概念，用来描述电子快门和电子枪的工作方式，在视频中的"逐行扫描"其实就相当于摄影机中的全域快门) 

1920*1080
#### 2160p == 4k
3840*2160

### HDR10
HDR10是消费者技术协会2015年宣布的开放标准，使用它不需要支付任何版权费，其中的"10"来自于10位色深，除了色深之外，HDR10建议使用广色域Rec.2020、PQ (SMTPE ST2084) 绝对值显示，以及静态数据处理方式。
HDR10是最基础的HDR标准，也是目前应用最广泛的标准，几乎所有的主流电视制造商以及流媒体厂家都支持HDR10，好莱坞的七大电影公司  (索尼、二十世纪福克斯、迪士尼、华纳兄弟、派拉蒙、环球，以及新晋的Netflix) 也都会采用HDR10来制作高清蓝光格式的资源。除了上述影像领域的资深厂商，Xbox One、PS4以及Apple TV 4K等客厅娱乐终端也都支持HDR10。
但HDR10尽管应用最广泛，但它的缺点也很明显，HDR10的出发点是网络流媒体和高清电视节目，很少会考虑普通电视的收看需求 (广播电视、电影) 。如上图所示的Rec.2020广色域，除了部分流媒体会去尝试，电影行业还是会老老实实的用P3，纯种HDR10节目并不好找。更别提电视本身能达到P3就已经是优秀标准了，规定建议的Rec.2020广色域没有实际意义。

### 蓝光原盘
保留蓝光盘上所有的内容，保留了完整菜单结构，包括章节、各种音轨、等彩带结构，完整的抓取到硬盘上，简单点说这里的"蓝光原盘"和蓝光BD上的内容完全一样，只是存储介质不同，一个是在硬盘上 (当然是为了网络传输) ，一个是在BD光盘上，蓝光原盘的容量一般在25G以上，在电脑上播蓝光原盘需要特殊软件,如TMT3,TMT5,PD11等，对电脑配置的要求也较高，适用于高清发烧友或收藏者。
### REMUX: 
无损提取原盘里的视频和音频，重新封装 (一般封装后的文件后缀是TS) 。REMUX就画质和音质上与原盘是无区别的，只是为了减少容量，删掉了原盘上的菜单、花絮、其他音轨，这叫原盘的减肥，不在乎菜单、花絮、其他音轨的发烧友收藏REMUX是比较明智的，而且REMUX在播放上比原盘简单些，又支持外挂字幕，是不错的东西。

### ffmpeg
    ffmpeg -i xxx.mp4
    ffprobe [文件名] 
    ffprobe -show_format  pm.mp4 
    ffprobe -print_format json  -show_streams pm.mp4 
    显示帧信息

ffprobe -show_frames pm.mp4
4. 查看包信息

ffprobe -show_packets pm.mp4

### 转换 input.mp4 视频文件到 output.mp3 音频文件。
    ffmpeg -i input.mp4 -vn output.mp3
    # 对输出文件使用各种各样的音频转换编码选项
    ffmpeg -i input.mp4 -vn -ar 44100 -ac 2 -ab 320 -f mp3 output.mp3

---

https://zhuanlan.zhihu.com/p/67878761