---
title: VMWare 网络
author: "-"
date: 2011-12-04T07:27:50+00:00
url: /?p=1782
categories:
  - Network
tags:
  - reprint
---
## VMWare 网络
<http://bbs.ylmf.net/forum.php?mod=viewthread&tid=1764295&extra=>

VMWare虚拟系统上网设置及VMWare虚拟机三种工作模式详解
  
很多网友安装了VMWare虚拟机，但是在虚拟机上网问题上却卡住了。要想虚拟机上网，首先让我们了解一下VMWare虚拟机三种工作模式。现在，让我们一起走近VMWare的三种工作模式。

理解三种工作模式

VMWare提供了三种工作模式，它们是bridged(桥接模式)、NAT(网络地址转换模式)和host-only(主机模式)。要想在网络管理和维护中合理应用它们，你就应该先了解一下这三种工作模式。

1.bridged(桥接模式)

在这种模式下，VMWare虚拟出来的操作系统就像是局域网中的一台立的主机，它可以访问网内任何一台机器。在桥接模式下，你需要手动为虚拟系统配置IP地址、子网掩码，而且还要和宿主机器处于同一网段，这样虚拟系统才能和宿主机器进行通信。同时，由于这个虚拟系统是局域网中的一个独立的主机系统，那么就可以手工配置它的TCP/IP配置信息，以实现通过局域网的网关或路由器访问互联网。

使用桥接模式的虚拟系统和宿主机器的关系，就像连接在同一个Hub上的两台电脑。想让它们相互通讯，你就需要为虚拟系统配置IP地址和子网掩码，否则就无法通信。 如果是你是局域网上网方式，虚拟机使用网桥连接方式，只要设置虚拟机的IP地址与本机是同一网段，子网、网关、DNS与本机相同就能实现上网，也能访问局域网络。

如果你是拨号上网方式，虚拟机使用此种方式连接，就要在虚拟机内系统建立宽带连接、拨号上网，但是和 宿主机不能同时上网。

2.NAT(网络地址转换模式)

使用NAT模式，就是让虚拟系统借助NAT(网络地址转换)功能，通过宿主机器所在的网络来访问公网。也就是说，使用NAT模式可以实现在虚拟系统里访问互联网。NAT模式下的虚拟系统的TCP/IP配置信息是由VMnet8(NAT)虚拟网络的DHCP服务器提供的，无法进行手工修改，因此使用NAT模式虚拟系统也就无法和本地局域网中的其他真实主机进行通讯。
  
采用NAT模式最大的优势是虚拟系统接入互联网非常简单，你不需要进行任何其他的配置，只需要宿主机器能访问互联网，虚拟机就能访问互联网。
  
设置上网方式: 本机网上邻居属性->VMnet8属性->TCP/IP属性->常规与备用配置都设定为自动获取，虚拟机网上邻居TCP/IP都设定为自动，虚拟网络设置设定如下面图所示
  
详细步骤: 
  
1.把你的虚拟网卡VMnet8设置为自动获得IP、自动获得DNS 服务器，启用。

如果你想利用VMWare安装一个新的虚拟系统，在虚拟系统中不用进行任何手工配置就能直接访问互联网，建议你采用NAT模式。

注释: 以上所提到的NAT模式下的VMnet8虚拟网络，host-only模式下的VMnet1虚拟网络，以及bridged (桥接) 模式下的VMnet0虚拟网络，都是由VMWare虚拟机自动配置而生成的，不需要用户自行设置。VMnet8和VMnet1提供DHCP服务，VMnet0虚拟网络则不提供。
  
[url=][/url]
  
点击VMnet8,再点击开始按钮
  
[url=][/url]

点击开始按钮
  
[url=][/url]

3.host-only(主机模式)

在某些特殊的网络调试环境中，如何要求将真实环境和虚拟环境隔离开，这时你就可采用host-only模式。在host-only模式中，所有的虚拟系统是可以相互通信的，但虚拟系统和真实的网络是被隔离开的，VMWare虚拟机不能访问互联网。

提示: 在host-only模式下，虚拟系统和宿主机器系统是可以相互通信的，相当于这两台机器通过双绞线互连。

在host-only模式下，虚拟系统的TCP/IP配置信息(如IP地址、网关地址、DNS服务器等)，都是由VMnet1(host-only)虚拟网络的DHCP服务器来动态分配的。

如果你想利用VMWare创建一个与网内其他机器相隔离的虚拟系统，进行某些特殊的网络调试工作，可以选择host-only模式。
  
配置虚拟系统工作模式

在实际的工作中，由于用户的需求不同、调试环境的要求不同，不同的用户需要选择不同的工作模式，也许是bridged (桥接) 模式，也可能是NAT模式或host-only模式。不管选择使用何种工作模式，将虚拟系统配置成相应的工作模式是非常简单的，在"新建虚拟机向导"对话框中就可以完成。

在"新建虚拟机向导"对话框中一路点击"下一步"按钮，进入"网络类型"对话框后，就可以选择你所使用的工作模式。在"网络类型"对话框中有四个单选项，分别为bridged (桥接) 模式、NAT模式、host-only模式、不使用网络连接，选择你需要使用的工作模式后，点击"下一步"按钮，就可完成虚拟系统工作模式的配置。
  
[url=][/url]

注意:1.要确保VMware Network Adapter for VMnet8 处于启用状态，这个是NAT网络模式要用的虚拟网卡。注意这个网卡的IP地址，不需要做手动设置，切记!
  
2.把你虚拟机中操作系统的"本地连接"也设置为自动获得IP、自动获得DNS服务器 (在虚拟机中，右键"本地连接"－双击"Internet协议"，看看是不是自动的吧！固定IP的也在这里改！) 

3.当然是将虚拟机的上网方式选为NAT 。
  
在虚拟机里安装好操作系统，启动虚拟系统，打开IE浏览器，这时候正常的话虚拟机就可以上网了，切记!!虚拟系统中的网卡也不需要做任何设置。
  
右键你要设置的虚拟机选"设置" (因为有的不止虚拟一台) ，在"硬件"中选"以太网"，将右边的网络连接改为NAT －确定。
  
4.点菜单栏里的"编辑"－选"虚拟网络设置"，先将"自动桥接"给去掉 (去掉钩钩) ，再选"DHCP"开启DHCP服务，点"开始"－应用，再按同样的方法开启"NAT "的功能。
  
5.最重要的是你的两个服务必须开启: VMware DHCP Service 和VMware NATService. 具体操作如下: 开始——设置——控制面板——管理工具——服务，确保 VMwareDHCP Service和VMware NAT Service服务已经启动。
  
关于虚拟机使用NAT不能上网的若干问题
  
许多朋友，在使用VMware Workstation的时候，创建的虚拟机使用NAT，但在虚拟机中却不能上网，原因可能如下: 
  
1. 主机是Windows XP Professional SP2或者是Windows Server2003 SP1，如果是这样，则需要把VMnet1、VMnet8的防火墙关闭。
  
方法是: 右击"本地连接"选择属性→高级→设置，在"Windows防火墙"对话框中单击"高级"，将VMnet1和VMnet8前面的"√"去掉就可以。
  
2. 你的主机安装了瑞星、江民或者天网防火墙，或者其他防火墙软件，这些防火墙软件你没有进行正确的配置，导致VMware不能通过其内置的NAT功能共享上网，这时，可以把第三方的防火墙软件关闭。
  
3. 你可能在VMnet8或者VMnet1启用了XP内置的"Internet连接共享"，你要知道，使用VMware的NAT功能，你不需要在 主机上启用共享，因为VMware已经内置了NAT的共享。如果是这样，请去掉这些共享，然后重新启动VMware 的NAT服务(或者重新启动计算机)
  
4. 可能是你使用了VMware Workstation的"绿色"版或者"精简"版。如果是这样，请使用完整版本安装。如果你需要中文，可以安装中文的汉化补丁。
  
推荐作法: 
  
主机不安装第三方的防火墙软件，安装VMware Workstation的完整版本(就是从VMware Workstation网站或者一些下载网站下载的VMware Workstation的英文版(VMware-workstation-5.5.3-34685的大小是92.4M)，安装汉化补丁，修改XP的防火墙，让VMnet1和VMnet8不使用防火墙(主机网卡使用)。创建虚拟机使用NAT网卡，在虚拟机中设置为"自动获得IP及DNS地址"，这样做，一般情况下都可以直接上网。
  
关于VMware用NAT与主机共享上网的一般设置
  
虚拟机的网络连接里的"本地连接"就用"自动获取IP地址"就好，有固定IP的需要到"Internet协议"设置。 (右键"本地连接"－双击"Internet 协议"，看看是不是自动的吧！固定IP的也在这里改！) 
  
1.当然是将虚拟机的上网方式选为NAT咯。右键你要设置的虚拟机选"设置" (因为有的不止虚拟一台) ，在"硬件"中选"以太网"，将右边的网络连接改为NAT－确定。
  
2.点菜单栏里的"编辑"－选"虚拟网络设置"，先将"自动桥接"给去掉 (去掉钩钩) ，再选"DHCP"开启DHCP服务，点"开始"－应用，再按同样的方法开启"NAT"的功能。
  
NAT的上网方式的特点
  
1.主机的虚拟网卡不用设置 (默认为自动获得) 
  
2.虚拟系统中的网卡不用设置 (默认为自动获得) 
  
这条两个实现的前提是虚拟的dhcp服务器正常工作
  
第二种方式上网: 桥接方式
  
虚拟机选择"桥接"，桥接之后便可以直接上网了，但是不能和主机共享资料，所以我采用"共享"的方式，使得虚拟机共享主机网卡，从而达到上网和共享主机资料的目的。
  
在网上邻居--属性-ADSL-属性-高级--Internet连接共享--把底下的"允许其它计算机......"那项勾上，然后选择底下的选项为"本地连接"---确定