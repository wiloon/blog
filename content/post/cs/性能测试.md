---
title: 性能测试
author: "-"
date: 2020-04-21T00:41:08+00:00
url: /?p=16014
categories:
  - Inbox
tags:
  - reprint
---
## 性能测试

性能测试是什么: 性能测试就是通过特定的方式对被测试系统按照一定测试策略施加压力，获取该系统的响应时间、TPS、吞吐量、资源利用率等性能指标，来检测系统上线后能否满足用户需求的过程。
  
性能测试要统一考虑这么几个因素: Thoughput吞吐量/吞吐率，Latency响应时间，资源利用 (CPU/MEM/IO/Bandwidth…) ，成功率，系统稳定性。

### 并发数

并发数是指系统同时能处理的请求数量，这个也是反应了系统的负载能力。
  
响应时间
  
响应时间是一个系统最重要的指标之一，它的数值大小直接反应了系统的快慢。响应时间是指执行一个请求从开始到最后收到响应数据所花费的总体时间。

### 吞吐量/吞吐率

吞吐量是指单位时间内系统能处理的请求数量，体现系统处理请求的能力，这是目前最常用的性能测试指标。
  
QPS (每秒查询数) 、TPS (每秒事务数) 是吞吐量的常用量化指标，另外还有HPS (每秒HTTP请求数) 。
  
跟吞吐量有关的几个指标是: 并发数、响应时间。
  
QPS (TPS) ，并发数、响应时间它们三者之间的关系是:
  
QPS (TPS) =并发数/平均响应时间

响应时间
  
指的是客户发出请求到得到响应的整个过程的时间。在某些工具中，请求响应时间通常会被称为"TTLB"(Time to laster byte) ,意思是从发起一个请求开始，到客户端收到最后一个字节的响应所耗费的时间。
  
[https://blog.wiloon.com/?p=16015](https://blog.wiloon.com/?p=16015)

### 资源指标

CPU使用率: 指用户进程与系统进程消耗的CPU时间百分比，长时间情况下，一般可接受上限不超过85%。
  
CPU指标主要指的CPU利用率，包括用户态(user)、系统态(sys)、等待态(wait)、空闲态(idle)。

CPU 利用率要低于业界警戒值范围之内，即小于或者等于75%;
  
CPU sys%小于或者等于30%;
  
CPU wait%小于或者等于5%；
  
内存利用率: 内存利用率=(1-空闲内存/总内存大小)*100%，一般至少有10%可用内存，内存使用率可接受上限为85%。
  
磁盘I/O: 磁盘主要用于存取数据，因此当说到IO操作的时候，就会存在两种相对应的操作，存数据的时候对应的是写IO操作，取数据的时候对应的是是读IO操作，一般使用% Disk Time(磁盘用于读写操作所占用的时间百分比)度量磁盘读写性能。
  
网络带宽: 一般使用计数器Bytes Total/sec来度量，Bytes Total/sec表示为发送和接收字节的速率，包括帧字符在内。判断网络连接速度是否是瓶颈，可以用该计数器的值和目前网络的带宽比较。

系统指标

并发用户数: 某一物理时刻同时向系统提交请求的用户数。

在线用户数: 某段时间内访问系统的用户数，这些用户并不一定同时向系统提交请求。

平均响应时间: 系统处理事务的响应时间的平均值。事务的响应时间是从客户端提交访问请求到客户端接收到服务器响应所消耗的时间。对于系统快速响应类页面，一般响应时间为3秒左右。

事务成功率: 性能测试中，定义事务用于度量一个或者多个业务流程的性能指标，如用户登录、保存订单、提交订单操作均可定义为事务
  
系统处理能力
  
定义和解释: 系统处理能力是指系统在利用系统硬件平台和软件平台进行信息处理的能力。系统处理能力通过系统每秒钟能够处理的交易数量来评价，交易有两种理解: 一是业务人员角度的一笔业务过程；二是系统角度的一次交易申请和响应过程。前者称为业务交易过程，后者称为事务。两种交易指标都可以评价应用系统的处理能力。

一般情况下，系统处理能力又用以下几个指标来度量:

HPS (Hits Per Second)  : 每秒点击次数，单位是次/秒。
  
TPS (Transaction per Second) : 系统每秒处理交易数，单位是笔/秒。
  
QPS (Query per Second) : 系统每秒处理查询次数，单位是次/秒。

    性能测试应该怎么做？
  
[https://coolshell.cn/articles/17381.html/embed#?secret=NrNpWdMxM0](https://coolshell.cn/articles/17381.html/embed#?secret=NrNpWdMxM0)
  
[https://blog.csdn.net/u012562943/java/article/details/78799927](https://blog.csdn.net/u012562943/java/article/details/78799927)
  
[https://www.cnblogs.com/fnng/archive/2012/07/01/2571990.html](https://www.cnblogs.com/fnng/archive/2012/07/01/2571990.html)

[https://testerhome.com/articles/21178](https://testerhome.com/articles/21178)

    负载测试、压力测试和性能测试的区别
  
[http://blog.wiloon.com/?p=8284&embed=true#?secret=nTyfEceLtf](http://blog.wiloon.com/?p=8284&embed=true#?secret=nTyfEceLtf)

## 性能测试 – 吞吐量

吞吐量

指在一次性能测试过程中网络上传输的数据量的总和。

对于交互式应用来说，吞吐量指标反映的是服务器承受的压力，在容量规划的测试中，吞吐量是一个重点关注的指标，因为它能够说明系统级别的负载能力，另外，在性能调优过程中，吞吐量指标也有重要的价值。如一个大型工厂，他们的生产效率与生产速度很快，一天生产10W吨的货物，结果工厂的运输能力不行，就两辆小型三轮车一天拉2吨的货物，比喻有些夸张，但我想说明的是这个运输能力是整个系统的瓶颈。

提示，用吞吐量来衡量一个系统的输出能力是极其不准确的，用个最简单的例子说明，一个水龙头开一天一夜，流出10吨水；10个水龙头开1秒钟，流出0.1吨水。当然是一个水龙头的吞吐量大。你能说1个水龙头的出水能力是10个水龙头的强？所以，我们要加单位时间，看谁1秒钟的出水量大。这就是吞吐率。

吞吐率

单位时间内网络上传输的数据量，也可以指单位时间内处理客户请求数量。它是衡量网络性能的重要指标，通常情况下，吞吐率用"字节数/秒"来衡量，当然，你可以用"请求数/秒"和"页面数/秒"来衡量。其实，不管是一个请求还是一个页面，它的本质都是在网络上传输的数据，那么来表示数据的单位就是字节数。

不过以不同的方式表达的吞吐量可以说明不同层次的问题。例如，以字节数/秒方式表示的吞吐量主要受网络基础设置、服务器架构、应用服务器制约；以请求数/秒方式表示的吞吐量主要受应用服务器和应用代码的制约。

但是从业务的角度看，吞吐率也可以用"业务数/小时或天"、"访问人数/小时或天"、"页面访问量/小时或天"来衡量。例如，在银行卡审批系统中，可以用"千件/小时"来衡量系统的业务处理能力。那么，从用户的角度，一个表单提交可以得到一次审批。又引出来一个概念-事务。

事务

就是用户某一步或几步操作的集合。不过，我们要保证它有一个完整意义。比如用户对某一个页面的一次请求，用户对某系统的一次登录，淘宝用户对商品的一次确认支付过程。这些我们都可以看作一个事务。那么如何衡量服务器对事务的处理能力。又引出一个概念--TPS

TPS (Transaction Per second)

每秒钟系统能够处理事务或交易的数量，它是衡量系统处理能力的重要指标。

点击率 (Hit Per Second)

点击率可以看做是TPS的一种特定情况。点击率更能体现用户端对服务器的压力。TPS更能体现服务器对客户请求的处理能力。

每秒钟用户向web服务器提交的HTTP请求数。这个指标是web 应用特有的一个指标；web应用是"请求-响应"模式，用户发一个申请，服务器就要处理一次，所以点击是web应用能够处理的交易的最小单位。如果把每次点击定义为一个交易，点击率和TPS就是一个概念。容易看出，点击率越大。对服务器的压力也越大，点击率只是一个性能参考指标，重要的是分析点击时产生的影响。

需要注意的是，这里的点击不是指鼠标的一次"单击"操作，因为一次"单击"操作中，客户端可能向服务器发现多个HTTP请求。

吞吐量指标的作用:

再次将话题回归到吞吐量上，在我们的性能测试中查看吞吐量对我们的测试有什么意义呢。

1. 用户协助设计性能测试场景，以及衡量性能测试场景是否达到了预期的设计目标: 在设计性能测试场景时，吞吐量可被用户协助设计性能测试场景，根据估算的吞吐量数据，可以对应到测试场景的事务发生频率，事务发生次数等；另外，在测试完成后，根据实际的吞吐量可以衡量测试是否达到了预期的目标。

2. 用于协助分析性能瓶颈: 吞吐量的限制是性能瓶颈的一种重要表现形式，因此，有针对性地对吞吐量设计测试，可以协助尽快定位到性能冰晶所在位置。

[https://www.cnblogs.com/fnng/archive/2012/06/29/2570558.html](https://www.cnblogs.com/fnng/archive/2012/06/29/2570558.html)
