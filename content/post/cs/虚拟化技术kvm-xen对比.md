---
title: 虚拟化技术 KVM Xen 对比
author: "-"
date: 2011-11-26T08:03:25+00:00
url: /?p=1627
categories:
  - Linux
  - VM
tags:
  - reprint
---
## 虚拟化技术 KVM Xen 对比
Linux虚拟化技术的用户目前有两种免费的开源管理程序可以选择: Xen和KVM。
  
作为较早出现的虚拟化技术，Xen是"第一类"运行在裸机上的虚拟化管理程序 (Hypervisor) ，也是当前相当一部分商业化运作公司的基础技术，其中包括Citrix系统公司的XenServer和Oracle的虚拟机。Xen技术的倡导者们声称Xen的性能强劲，并且拥有一个广泛的管理工具和能够交付卓越性能，以及其它诸多优点。
  
但是最近有一些Linux厂商-包括Red Hat和Canonical把基于内核的虚拟机 (KVM: Kernel-based Virtual Machine) 技术内置在Ubuntu中。KVM是一个轻量级的虚拟化管理程序模块，该模块主要来自于Linux内核。虽然只是后来者，但是由于其性能和实施的简易性，以及对Linux重量级的持续支持，所以还是有必要认真对待KVM技术的。
  
在本期虚拟化面面观中，两位IT专家将会对Xen和KVM做出比较，并给出各自的理由。
  
Andi Mann: Xen比KVM优越的六大原因
  
Sander van Vugt: KVM比Xen能够带来更好的Linux集成
  
Xen比KVM优越的六大原因
  
投稿人: Andi Mann
  
作为开源的虚拟化技术，对比Xen和KVM可以看到，Xen以6个无与伦比的优势领先: 更好的可用资源、平台支持、可管理性、实施、动态迁移和性能基准。
  
可用资源: Xen的问世要比KVM早4年之久 (两者分别是2003年和2007年) 。随着Citrix、Novell、Oracle、Sun、Ret Hat和Virtual Iron等公司在市场领域的实施，就比较容易找到精通Xen的IT技术人员，更容易让这些技术人员接受Xen相关的培训、更容易得到Xen的咨询帮助以及获得Xen证书。企业管理协会 (EMA: Enterprise Management Associates) 2008年这对虚拟化和管理趋势的研究报告表明，这些关键因素占到那些抱怨缺少必要虚拟化技术资源和技术企业的60%。
  
平台支持: Xen在新版本中支持更多的主机和客体工作环境，包括泛虚拟化技术、硬件辅助支持以及修改过或未修改过的客体操作系统；对UNIX、Linux和Microsoft Windows的特定支持；包括芯片组，如x86、IA64和AMD、Fujitsu、IBM、Sun等公司的ARM，以及x86/64 CPU商家和Intel嵌入式的支持等。
  
可管理性: EMA在2009年度针对虚拟系统管理的研究结果表明: 对于83%的企业来讲，在选择虚拟化技术过程中，管理是一项非常关键或者重要的因素。在对比Xen和KVM时，就可以看到Xen具有一个更加宽泛的第三方配给、备份、存储管理、P2V、容量规划、性能监控、进程自动化、安全和其它管理规则的社区，比如Citrix、IBM、CA、Novell或者Platespin、Enomaly、Microsoft以及HP等。
  
实施: 无论KVM是"第一类"还是"第二类"，这都是语义上的概念。Xen的运行和管理都是在较低级别的 (Ring 0) 。甚至对于新虚拟机创建，客体机器并不需要像KVM那样共享内存块、CPU指令或者任何底层的Linux操作系统 (虽然偶尔也会越权) 。
  
KVM不支持动态迁移: 过去在证明VMware ESX比Microsoft Hyper-V优越的最重要的一个观点也同样适用于Xen和KVM的比较，但是这是一个很大的问题。与KVM不同，Xen支持非中断的动态迁移，可以允许动态工作负载平衡和例行维护而几乎没有任何宕机时间。KVM的固有属性决定了其肯定有宕机时间。
  
性能: 大多数Xen和KVM性能基准的对比都表明Xen具有更好的处理性能 (接近于本地处理) ，只有在磁盘I/O方面略逊于KVM。进一步来讲，独立测试表明随着工作负载的增加KVM的性能逐渐下降。通常情况下，在试图支持四个以上的客体虚拟机时就会崩溃。Xen支持一个客体虚拟机的数量呈线性增长，可以支持30个以上工作负载同时运行。
  
更加深入广泛的Xen与 KVM对比也将会表明Xen在虚拟网络支持、虚拟存储支持、安全增强、高可用性、容错处理、电源管理、HPC或者实时支持、虚拟CPU可扩展性、跨平台兼容性。虚拟机可移植性、虚拟应用设备市场以及已经建立起来的云服务社区等诸多方面都要比KVM优越。因此KVM只是在技术上比较与众不同，并且拥有几个不错的应用场景。但是作为企业级的服务器虚拟化技术，和Xen比起来，KVM尚有较大差距。
  
Andi Mann是企业管理协会 (EMA: Enterprise Management Associates) IT分析部门中研究系统管理和存储管理的副总裁。Mann在技术和管理领域有20多年的IT经验，对主机、中型机、服务器和台式机上企业形态和软件方面都有深刻理解。Mann是EMA系统管理研究项目的主要负责人，他主要关注数据中心自动化和虚拟化。访问EMA的主页了解更多有关Mann的信息。
  
KVM在Linux整合中优于Xen
  
投稿人: Sander van Vugt
  
即使没有实施广泛的Xen和KVM性能基准研究，仍然有很多理由足以说明Linux领导者 (诸如Red Hat和Ubuntu) 对待KVM态度的原因。其中最明显并且最重要的因素就是KVM是Linux内核的一部分，Xen只是一个安装在Linux内核下层的一个产品而已。
  
为什么这一点如此重要呢？其之所以重要是因为在过去Xen工作环境的补丁包不能够和Linux内核兼容。但是如果实施KVM的话，这个问题就可以很容易地得到解决。另外一个选择KVM的原因是KVM在Linux内核内部部署，这样可以很容易控制虚拟化进程。
  
Xen的拥护者们声称KVM不如Xen技术成熟，并且缺少某些关键特性，如动态迁移和泛虚拟化支持。确实如此，Xen工作环境中的泛虚拟化技术可以使虚拟机的操作更加高效，因为泛虚拟化技术直接和硬件进行交互。然而使用泛虚拟化技术需要修改操作系统，默认Windows的安装并不支持泛虚拟化工作环境。至于动态迁移，KVM也可以做到，只是需要安装正确的KVM版本而已。KVM过去在动态迁移方面确实存在一个问题，但是现在已经解决了。
  
从另外一个角度来讲，KVM更加灵活。由于操作系统直接和整合到Linux内核中的虚拟化管理程序交互，所以在任何场景下都可以直接和硬件进行交互，而不需要修改虚拟化的操作系统。这一点非常重要，因为对虚拟机运行来讲KVM可以是一个更快的解决方案。KVM需要Pacifica (AMD) 或者Vanderpool (Intel) 虚拟化CPU这一事实现在已经不能成为KVM发展的限制条件，因为当前大多数服务器CPU都有这些处理器。
  
支持不选择KVM虚拟化技术的一个可信原因是Xen相对来讲历史更久一点，产品更加成熟些。但是长远来看，Xen将会使Linux内核的负担越来越重，因为Xen缺少很好的整合 (并且以后也不会解决这个问题) ，尽管Xen的开发者们正在积极地解决这个整合问题。
  
最后一点是KVM是Linux内核的一部分，而Xen做到最好也无非是整合到Linux中。随着时间的推移，Ret Hat (目前掌握KVM技术) ，作为Linux企业市场中份额最大的企业，将会使虚拟化技术的后来者-KVM同Xen一样功能齐全。我相信未来虚拟化市场必定是KVM的。