---
title: ForkJoin
author: "-"
date: 2017-06-22T02:11:10+00:00
url: ForkJoin
categories:
  - cs
tags:
  - reprint
---
## ForkJoin

ä»€ä¹ˆæ˜¯ Fork/Join æ¡†æ¶
Fork/Join æ¡†æ¶æ˜¯ Java7 æä¾›çš„ä¸€ä¸ªç”¨äºå¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„æ¡†æ¶(Fork/Join Framework)ï¼Œ æ˜¯ä¸€ä¸ªæŠŠå¤§ä»»åŠ¡åˆ†å‰²æˆè‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼Œæœ€ç»ˆæ±‡æ€»æ¯ä¸ªå°ä»»åŠ¡ç»“æœåå¾—åˆ°å¤§ä»»åŠ¡ç»“æœçš„æ¡†æ¶ã€‚

æˆ‘ä»¬å†é€šè¿‡ Fork å’Œ Join è¿™ä¸¤ä¸ªå•è¯æ¥ç†è§£ä¸‹ Fork/Join æ¡†æ¶ï¼ŒFork å°±æ˜¯æŠŠä¸€ä¸ªå¤§ä»»åŠ¡åˆ‡åˆ†ä¸ºè‹¥å¹²å­ä»»åŠ¡å¹¶è¡Œçš„æ‰§è¡Œï¼ŒJoin å°±æ˜¯åˆå¹¶è¿™äº›å­ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œæœ€åå¾—åˆ°è¿™ä¸ªå¤§ä»»åŠ¡çš„ç»“æœã€‚æ¯”å¦‚è®¡ç®— 1+ 2+... + 10000ï¼Œå¯ä»¥åˆ†å‰²æˆ 10 ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åˆ†åˆ«å¯¹ 1000 ä¸ªæ•°è¿›è¡Œæ±‚å’Œï¼Œæœ€ç»ˆæ±‡æ€»è¿™ 10 ä¸ªå­ä»»åŠ¡çš„ç»“æœã€‚

## ForkJoinPool

<http://blog.dyngr.com/blog/2016/09/15/java-forkjoinpool-internals/>

ForkJoinPool ä¸æ˜¯ä¸ºäº†æ›¿ä»£ ExecutorService, è€Œæ˜¯å®ƒçš„è¡¥å……, åœ¨æŸäº›åº”ç”¨åœºæ™¯ä¸‹æ€§èƒ½æ¯” ExecutorService æ›´å¥½ã€‚ (è§ Java Tip: When to use ForkJoinPool vs ExecutorService )
  
ForkJoinPool ä¸»è¦ç”¨äºå®ç°"åˆ†è€Œæ²»ä¹‹"çš„ç®—æ³•,ç‰¹åˆ«æ˜¯åˆ†æ²»ä¹‹åé€’å½’è°ƒç”¨çš„å‡½æ•°, ä¾‹å¦‚ quick sort ç­‰ã€‚

ForkJoinPool æœ€é€‚åˆçš„æ˜¯è®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡, å¦‚æœå­˜åœ¨ I/O, çº¿ç¨‹é—´åŒæ­¥, sleep() ç­‰ä¼šé€ æˆçº¿ç¨‹é•¿æ—¶é—´é˜»å¡çš„æƒ…å†µæ—¶, æœ€å¥½é…åˆä½¿ç”¨ ManagedBlockerã€‚
  
## ä½¿ç”¨

æ±‚æ•´æ•°æ•°ç»„æ‰€æœ‰å…ƒç´ ä¹‹å’Œ

é—®é¢˜

è®¡ç®—1 è‡³1000 çš„æ­£æ•´æ•°ä¹‹å’Œã€‚

è§£å†³æ–¹æ³•

## For-loop
  
æœ€ç®€å•çš„, æ˜¾ç„¶æ˜¯ä¸ä½¿ç”¨ä»»ä½•å¹¶è¡Œç¼–ç¨‹çš„æ‰‹æ®µ, åªç”¨æœ€ç›´ç™½çš„ for-loop æ¥å®ç°ã€‚ä¸‹é¢å°±æ˜¯å…·ä½“çš„å®ç°ä»£ç ã€‚

ä¸è¿‡ä¸ºäº†ä¾¿äºæ¨ªå‘å¯¹æ¯”, ä¹Ÿä¸ºäº†è®©ä»£ç æ›´åŠ  Java Style, é¦–å…ˆæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ª interfaceã€‚

```java
public interface Calculator {
    long sumUp(long[] numbers);
}
```

è¿™ä¸ª interface éå¸¸ç®€å•,åªæœ‰ä¸€ä¸ªå‡½æ•° sumUp, å°±æ˜¯è¿”å›æ•°ç»„å†…æ‰€æœ‰å…ƒç´ çš„å’Œã€‚

å†å†™ä¸€ä¸ª main æ–¹æ³•ã€‚

```java
public class Main {

public static void main(String[] args) {

long[] numbers = LongStream.rangeClosed(1, 1000).toArray();

Calculator calculator = new MyCalculator();

System.out.println(calculator.sumUp(numbers)); // æ‰“å°ç»“æœ500500

}
  
}
```

æ¥ä¸‹æ¥å°±æ˜¯æˆ‘ä»¬çš„ Plain Old For-loop Calculator,ç®€ç§° POFLC çš„å®ç°äº†ã€‚ (è¿™å…¶å®æ˜¯ä¸ªæ®µå­,å’Œä¸»é¢˜å®Œå…¨æ— å…³,æ„Ÿå…´è¶£çš„è¯·è§æ–‡æœ«çš„å½©è›‹)

```java
public class ForLoopCalculator implements Calculator {

public long sumUp(long[] numbers) {

long total = 0;

for (long i : numbers) {

total += i;

}

return total;

}
  
}
```

ForkJoinPool
  
å‰é¢èŠ±äº†ç‚¹æ—¶é—´è®²è§£äº† ForkJoinPool ä¹‹å‰çš„å®ç°æ–¹æ³•,ä¸»è¦ä¸ºäº†åœ¨ä»£ç çš„ç¼–å†™éš¾åº¦ä¸Šè¿›è¡Œä¸€ä¸‹å¯¹æ¯”ã€‚ç°åœ¨å°±åˆ—å‡ºæœ¬ç¯‡æ–‡ç« çš„é‡ç‚¹â€”â€”ForkJoinPool çš„å®ç°æ–¹æ³•ã€‚

public class ForkJoinCalculator implements Calculator {

private ForkJoinPool pool;

    private static class SumTask extends RecursiveTask<Long> {
        private long[] numbers;
        private int from;
        private int to;
    
        public SumTask(long[] numbers, int from, int to) {
            this.numbers = numbers;
            this.from = from;
            this.to = to;
        }
    
        @Override
        protected Long compute() {
            // å½“éœ€è¦è®¡ç®—çš„æ•°å­—å°äº6æ—¶,ç›´æ¥è®¡ç®—ç»“æœ
            if (to - from < 6) {
                long total = 0;
                for (int i = from; i <= to; i++) {
                    total += numbers[i];
                }
                return total;
            // å¦åˆ™,æŠŠä»»åŠ¡ä¸€åˆ†ä¸ºäºŒ,é€’å½’è®¡ç®—
            } else {
                int middle = (from + to) / 2;
                SumTask taskLeft = new SumTask(numbers, from, middle);
                SumTask taskRight = new SumTask(numbers, middle+1, to);
                taskLeft.fork();
                taskRight.fork();
                return taskLeft.join() + taskRight.join();
            }
        }
    }
    
    public ForkJoinCalculator() {
        // ä¹Ÿå¯ä»¥ä½¿ç”¨å…¬ç”¨çš„ ForkJoinPool: 
        // pool = ForkJoinPool.commonPool()
        pool = new ForkJoinPool();
    }
    
    @Override
    public long sumUp(long[] numbers) {
        return pool.invoke(new SumTask(numbers, 0, numbers.length-1));
    }

}
  
å¯ä»¥çœ‹å‡º,ä½¿ç”¨äº† ForkJoinPool çš„å®ç°é€»è¾‘å…¨éƒ¨é›†ä¸­åœ¨äº† compute() è¿™ä¸ªå‡½æ•°é‡Œ,ä»…ç”¨äº†14è¡Œå°±å®ç°äº†å®Œæ•´çš„è®¡ç®—è¿‡ç¨‹ã€‚ç‰¹åˆ«æ˜¯,åœ¨è¿™æ®µä»£ç é‡Œæ²¡æœ‰æ˜¾å¼åœ°"æŠŠä»»åŠ¡åˆ†é…ç»™çº¿ç¨‹",åªæ˜¯åˆ†è§£äº†ä»»åŠ¡,è€ŒæŠŠå…·ä½“çš„ä»»åŠ¡åˆ°çº¿ç¨‹çš„æ˜ å°„äº¤ç»™äº† ForkJoinPool æ¥å®Œæˆã€‚

åŸç†

å¦‚æœä½ é™¤äº† ForkJoinPool çš„ç”¨æ³•ä»¥å¤–,å¯¹ ForkJoinPoll çš„åŸç†ä¹Ÿæ„Ÿå…´è¶£çš„è¯,é‚£ä¹ˆè¯·æ¥ç€é˜…è¯»è¿™ä¸€èŠ‚ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­,æˆ‘ä¼šç»“åˆ ForkJoinPool çš„ä½œè€… Doug Lea çš„è®ºæ–‡â€”â€”ã€ŠA Java Fork/Join Frameworkã€‹,å°½å¯èƒ½é€šä¿—åœ°è§£é‡Š Fork/Join Framework çš„åŸç†ã€‚

æˆ‘ä¸€ç›´ä»¥ä¸º,è¦ç†è§£ä¸€æ ·ä¸œè¥¿çš„åŸç†,æœ€å¥½å°±æ˜¯è‡ªå·±å°è¯•ç€å»å®ç°ä¸€éã€‚æ ¹æ®ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ,å¯ä»¥çœ‹å‡º fork() å’Œ join() æ˜¯ Fork/Join Framework "é­”æ³•"çš„å…³é”®ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®å‡½æ•°åå‡è®¾ä¸€ä¸‹ fork() å’Œ join() çš„ä½œç”¨:

fork(): å¼€å¯ä¸€ä¸ªæ–°çº¿ç¨‹ (æˆ–æ˜¯é‡ç”¨çº¿ç¨‹æ± å†…çš„ç©ºé—²çº¿ç¨‹) ,å°†ä»»åŠ¡äº¤ç»™è¯¥çº¿ç¨‹å¤„ç†ã€‚
  
join(): ç­‰å¾…è¯¥ä»»åŠ¡çš„å¤„ç†çº¿ç¨‹å¤„ç†å®Œæ¯•,è·å¾—è¿”å›å€¼ã€‚
  
ä»¥ä¸Šæ¨¡å‹ä¼¼ä¹å¯ä»¥ (ï¼Ÿ) è§£é‡Š ForkJoinPool èƒ½å¤Ÿå¤šçº¿ç¨‹æ‰§è¡Œçš„äº‹å®,ä½†æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„é—®é¢˜

å½“ä»»åŠ¡åˆ†è§£å¾—è¶Šæ¥è¶Šç»†æ—¶,æ‰€éœ€è¦çš„çº¿ç¨‹æ•°å°±ä¼šè¶Šæ¥è¶Šå¤š,è€Œä¸”å¤§éƒ¨åˆ†çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ã€‚

ä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç åŠ å…¥ä»¥ä¸‹ä»£ç 

System.out.println(pool.getPoolSize());
  
è¿™ä¼šæ˜¾ç¤ºå½“å‰çº¿ç¨‹æ± çš„å¤§å°,åœ¨æˆ‘çš„æœºå™¨ä¸Šè¿™ä¸ªå€¼æ˜¯4,ä¹Ÿå°±æ˜¯è¯´åªæœ‰4ä¸ªå·¥ä½œçº¿ç¨‹ã€‚ç”šè‡³å³ä½¿æˆ‘ä»¬åœ¨åˆå§‹åŒ– pool æ—¶æŒ‡å®šæ‰€ä½¿ç”¨çš„çº¿ç¨‹æ•°ä¸º1æ—¶,ä¸Šè¿°ç¨‹åºä¹Ÿæ²¡æœ‰ä»»ä½•é—®é¢˜â€”â€”é™¤äº†å˜æˆäº†ä¸€ä¸ªä¸²è¡Œç¨‹åºä»¥å¤–ã€‚

public ForkJoinCalculator() {

pool = new ForkJoinPool(1);
  
}
  
è¿™ä¸ªçŸ›ç›¾å¯ä»¥å¯¼å‡º,æˆ‘ä»¬çš„å‡è®¾æ˜¯é”™è¯¯çš„,å¹¶ä¸æ˜¯æ¯ä¸ª fork() éƒ½ä¼šä¿ƒæˆä¸€ä¸ªæ–°çº¿ç¨‹è¢«åˆ›å»º,è€Œæ¯ä¸ª join() ä¹Ÿä¸æ˜¯ä¸€å®šä¼šé€ æˆçº¿ç¨‹è¢«é˜»å¡ã€‚Fork/Join Framework çš„å®ç°ç®—æ³•å¹¶ä¸æ˜¯é‚£ä¹ˆ"æ˜¾ç„¶",è€Œæ˜¯ä¸€ä¸ªæ›´åŠ å¤æ‚çš„ç®—æ³•â€”â€”è¿™ä¸ªç®—æ³•çš„åå­—å°±å«åš work stealing ç®—æ³•ã€‚

work stealing ç®—æ³•åœ¨ Doung Lea çš„è®ºæ–‡ä¸­æœ‰è¯¦ç»†çš„æè¿°,ä»¥ä¸‹æ˜¯æˆ‘åœ¨ç»“åˆ Java 1.8 ä»£ç çš„é˜…è¯»ä»¥åâ€”â€”ç°æœ‰ä»£ç çš„å®ç°æœ‰ä¸€éƒ¨åˆ†ç›¸æ¯”äºè®ºæ–‡ä¸­çš„æè¿°å‘ç”Ÿäº†å˜åŒ–â€”â€”å¾—åˆ°çš„ç›¸å¯¹é€šä¿—çš„è§£é‡Š:

åŸºæœ¬æ€æƒ³

ForkJoinPool çš„æ¯ä¸ªå·¥ä½œçº¿ç¨‹éƒ½ç»´æŠ¤ç€ä¸€ä¸ªå·¥ä½œé˜Ÿåˆ— (WorkQueue) ,è¿™æ˜¯ä¸€ä¸ªåŒç«¯é˜Ÿåˆ— (Deque) ,é‡Œé¢å­˜æ”¾çš„å¯¹è±¡æ˜¯ä»»åŠ¡ (ForkJoinTask) ã€‚
  
æ¯ä¸ªå·¥ä½œçº¿ç¨‹åœ¨è¿è¡Œä¸­äº§ç”Ÿæ–°çš„ä»»åŠ¡ (é€šå¸¸æ˜¯å› ä¸ºè°ƒç”¨äº† fork()) æ—¶,ä¼šæ”¾å…¥å·¥ä½œé˜Ÿåˆ—çš„é˜Ÿå°¾,å¹¶ä¸”å·¥ä½œçº¿ç¨‹åœ¨å¤„ç†è‡ªå·±çš„å·¥ä½œé˜Ÿåˆ—æ—¶,ä½¿ç”¨çš„æ˜¯ LIFO æ–¹å¼,ä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡ä»é˜Ÿå°¾å–å‡ºä»»åŠ¡æ¥æ‰§è¡Œã€‚
  
æ¯ä¸ªå·¥ä½œçº¿ç¨‹åœ¨å¤„ç†è‡ªå·±çš„å·¥ä½œé˜Ÿåˆ—åŒæ—¶,ä¼šå°è¯•çªƒå–ä¸€ä¸ªä»»åŠ¡ (æˆ–æ˜¯æ¥è‡ªäºåˆšåˆšæäº¤åˆ° pool çš„ä»»åŠ¡,æˆ–æ˜¯æ¥è‡ªäºå…¶ä»–å·¥ä½œçº¿ç¨‹çš„å·¥ä½œé˜Ÿåˆ—) ,çªƒå–çš„ä»»åŠ¡ä½äºå…¶ä»–çº¿ç¨‹çš„å·¥ä½œé˜Ÿåˆ—çš„é˜Ÿé¦–,ä¹Ÿå°±æ˜¯è¯´å·¥ä½œçº¿ç¨‹åœ¨çªƒå–å…¶ä»–å·¥ä½œçº¿ç¨‹çš„ä»»åŠ¡æ—¶,ä½¿ç”¨çš„æ˜¯ FIFO æ–¹å¼ã€‚
  
åœ¨é‡åˆ° join() æ—¶,å¦‚æœéœ€è¦ join çš„ä»»åŠ¡å°šæœªå®Œæˆ,åˆ™ä¼šå…ˆå¤„ç†å…¶ä»–ä»»åŠ¡,å¹¶ç­‰å¾…å…¶å®Œæˆã€‚
  
åœ¨æ—¢æ²¡æœ‰è‡ªå·±çš„ä»»åŠ¡,ä¹Ÿæ²¡æœ‰å¯ä»¥çªƒå–çš„ä»»åŠ¡æ—¶,è¿›å…¥ä¼‘çœ ã€‚
  
ä¸‹é¢æ¥ä»‹ç»ä¸€ä¸‹å…³é”®çš„ä¸¤ä¸ªå‡½æ•°: fork() å’Œ join() çš„å®ç°ç»†èŠ‚,ç›¸æ¯”æ¥è¯´ fork() æ¯” join() ç®€å•å¾ˆå¤š,æ‰€ä»¥å…ˆæ¥ä»‹ç» fork()ã€‚

fork

fork() åšçš„å·¥ä½œåªæœ‰ä¸€ä»¶äº‹,æ—¢æ˜¯æŠŠä»»åŠ¡æ¨å…¥å½“å‰å·¥ä½œçº¿ç¨‹çš„å·¥ä½œé˜Ÿåˆ—é‡Œã€‚å¯ä»¥å‚çœ‹ä»¥ä¸‹çš„æºä»£ç :

public final ForkJoinTask<V> fork() {

Thread t;

if ((t = Thread.currentThread()) instanceof ForkJoinWorkerThread)

((ForkJoinWorkerThread)t).workQueue.push(this);

else

ForkJoinPool.common.externalPush(this);

return this;
  
}
  
join

join() çš„å·¥ä½œåˆ™å¤æ‚å¾—å¤š,ä¹Ÿæ˜¯ join() å¯ä»¥ä½¿å¾—çº¿ç¨‹å…äºè¢«é˜»å¡çš„åŸå› â€”â€”ä¸åƒåŒåçš„ Thread.join()ã€‚

æ£€æŸ¥è°ƒç”¨ join() çš„çº¿ç¨‹æ˜¯å¦æ˜¯ ForkJoinThread çº¿ç¨‹ã€‚å¦‚æœä¸æ˜¯ (ä¾‹å¦‚ main çº¿ç¨‹) ,åˆ™é˜»å¡å½“å‰çº¿ç¨‹,ç­‰å¾…ä»»åŠ¡å®Œæˆã€‚å¦‚æœæ˜¯,åˆ™ä¸é˜»å¡ã€‚
  
æŸ¥çœ‹ä»»åŠ¡çš„å®ŒæˆçŠ¶æ€,å¦‚æœå·²ç»å®Œæˆ,ç›´æ¥è¿”å›ç»“æœã€‚
  
å¦‚æœä»»åŠ¡å°šæœªå®Œæˆ,ä½†å¤„äºè‡ªå·±çš„å·¥ä½œé˜Ÿåˆ—å†…,åˆ™å®Œæˆå®ƒã€‚
  
å¦‚æœä»»åŠ¡å·²ç»è¢«å…¶ä»–çš„å·¥ä½œçº¿ç¨‹å·èµ°,åˆ™çªƒå–è¿™ä¸ªå°å·çš„å·¥ä½œé˜Ÿåˆ—å†…çš„ä»»åŠ¡ (ä»¥ FIFO æ–¹å¼) ,æ‰§è¡Œ,ä»¥æœŸå¸®åŠ©å®ƒæ—©æ—¥å®Œæˆæ¬² join çš„ä»»åŠ¡ã€‚
  
å¦‚æœå·èµ°ä»»åŠ¡çš„å°å·ä¹Ÿå·²ç»æŠŠè‡ªå·±çš„ä»»åŠ¡å…¨éƒ¨åšå®Œ,æ­£åœ¨ç­‰å¾…éœ€è¦ join çš„ä»»åŠ¡æ—¶,åˆ™æ‰¾åˆ°å°å·çš„å°å·,å¸®åŠ©å®ƒå®Œæˆå®ƒçš„ä»»åŠ¡ã€‚
  
é€’å½’åœ°æ‰§è¡Œç¬¬5æ­¥ã€‚
  
å°†ä¸Šè¿°æµç¨‹ç”»æˆåºåˆ—å›¾çš„è¯å°±æ˜¯è¿™ä¸ªæ ·å­:

ä»¥ä¸Šå°±æ˜¯ fork() å’Œ join() çš„åŸç†,è¿™å¯ä»¥è§£é‡Š ForkJoinPool åœ¨é€’å½’è¿‡ç¨‹ä¸­çš„æ‰§è¡Œé€»è¾‘,ä½†è¿˜æœ‰ä¸€ä¸ªé—®é¢˜

æœ€åˆçš„ä»»åŠ¡æ˜¯ push åˆ°å“ªä¸ªçº¿ç¨‹çš„å·¥ä½œé˜Ÿåˆ—é‡Œçš„ï¼Ÿ

è¿™å°±æ¶‰åŠåˆ° submit() å‡½æ•°çš„å®ç°æ–¹æ³•äº†

submit

å…¶å®é™¤äº†å‰é¢ä»‹ç»è¿‡çš„æ¯ä¸ªå·¥ä½œçº¿ç¨‹è‡ªå·±æ‹¥æœ‰çš„å·¥ä½œé˜Ÿåˆ—ä»¥å¤–,ForkJoinPool è‡ªèº«ä¹Ÿæ‹¥æœ‰å·¥ä½œé˜Ÿåˆ—,è¿™äº›å·¥ä½œé˜Ÿåˆ—çš„ä½œç”¨æ˜¯ç”¨æ¥æ¥æ”¶ç”±å¤–éƒ¨çº¿ç¨‹ (é ForkJoinThread çº¿ç¨‹) æäº¤è¿‡æ¥çš„ä»»åŠ¡,è€Œè¿™äº›å·¥ä½œé˜Ÿåˆ—è¢«ç§°ä¸º submitting queue ã€‚

submit() å’Œ fork() å…¶å®æ²¡æœ‰æœ¬è´¨åŒºåˆ«,åªæ˜¯æäº¤å¯¹è±¡å˜æˆäº† submitting queue è€Œå·² (è¿˜æœ‰ä¸€äº›åŒæ­¥,åˆå§‹åŒ–çš„æ“ä½œ) ã€‚submitting queue å’Œå…¶ä»– work queue ä¸€æ ·,æ˜¯å·¥ä½œçº¿ç¨‹"çªƒå–"çš„å¯¹è±¡,å› æ­¤å½“å…¶ä¸­çš„ä»»åŠ¡è¢«ä¸€ä¸ªå·¥ä½œçº¿ç¨‹æˆåŠŸçªƒå–æ—¶,å°±æ„å‘³ç€æäº¤çš„ä»»åŠ¡çœŸæ­£å¼€å§‹è¿›å…¥æ‰§è¡Œé˜¶æ®µã€‚

æ€»ç»“

åœ¨äº†è§£äº† Fork/Join Framework çš„å·¥ä½œåŸç†ä¹‹å,ç›¸ä¿¡å¾ˆå¤šä½¿ç”¨ä¸Šçš„æ³¨æ„äº‹é¡¹å°±å¯ä»¥ä»åŸç†ä¸­æ‰¾åˆ°åŸå› ã€‚ä¾‹å¦‚: ä¸ºä»€ä¹ˆåœ¨ ForkJoinTask é‡Œæœ€å¥½ä¸è¦å­˜åœ¨ I/O ç­‰ä¼šé˜»å¡çº¿ç¨‹çš„è¡Œä¸ºï¼Ÿ,è¿™ä¸ªæˆ‘å§‘ä¸”ç•™ä½œæ€è€ƒé¢˜å§ ğŸ™‚

è¿˜æœ‰ä¸€äº›å»¶ä¼¸é˜…è¯»çš„å†…å®¹,åœ¨æ­¤ä»…æåŠä¸€ä¸‹:

ForkJoinPool æœ‰ä¸€ä¸ª Async Mode ,æ•ˆæœæ˜¯å·¥ä½œçº¿ç¨‹åœ¨å¤„ç†æœ¬åœ°ä»»åŠ¡æ—¶ä¹Ÿä½¿ç”¨ FIFO é¡ºåºã€‚è¿™ç§æ¨¡å¼ä¸‹çš„ ForkJoinPool æ›´æ¥è¿‘äºæ˜¯ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—,è€Œä¸æ˜¯ç”¨æ¥å¤„ç†é€’å½’å¼çš„ä»»åŠ¡ã€‚
  
åœ¨éœ€è¦é˜»å¡å·¥ä½œçº¿ç¨‹æ—¶,å¯ä»¥ä½¿ç”¨ ManagedBlockerã€‚
  
Java 1.8 æ–°å¢åŠ çš„ CompletableFuture ç±»å¯ä»¥å®ç°ç±»ä¼¼äº Javascript çš„ promise-chain,å†…éƒ¨å°±æ˜¯ä½¿ç”¨ ForkJoinPool æ¥å®ç°çš„ã€‚
  
å½©è›‹

ä¹‹æ‰€ä»¥ç…æœ‰ä»‹äº‹åœ°å–åä¸º POFLC,æ˜¾ç„¶æ˜¯ä¸ºäº†æ¨¡ä»¿ POJO ã€‚è€Œ POJO â€”â€” Plain Old Java Object è¿™ä¸ªè¯æ˜¯å¦‚ä½•äº§ç”Ÿçš„,åœ¨ stackoverflow ä¸Šæœ‰ä¸ªå¸–å­è®¨è®ºè¿‡,æ‘˜å½•ä¸€ä¸‹å°±æ˜¯

I've come to the conclusion that people forget about regular Java objects because they haven't got a fancy name. That's why, while preparing for a talk in 2000, Rebecca Parsons, Josh Mackenzie, and I gave them one: POJOs (plain old Java objects).

æˆ‘å¾—å‡ºä¸€ä¸ªç»“è®º: äººä»¬ä¹‹æ‰€ä»¥æ€»æ˜¯å¿˜è®°ä½¿ç”¨æ ‡å‡†çš„ Java å¯¹è±¡æ˜¯å› ä¸ºç¼ºå°‘ä¸€ä¸ªè¶³å¤Ÿè£…é€¼çš„åå­— (è¯‘æ³¨: ç±»ä¼¼äº Java Bean è¿™æ ·çš„åå­—) ã€‚å› æ­¤,åœ¨å‡†å¤‡2000å¹´çš„æ¼”è®²æ—¶,Rebecca Parsons,Josh Mackenzie å’Œæˆ‘ç»™ä»–ä»¬èµ·äº†ä¸€ä¸ªåå­—å«åš POJO  (å¹³æ·¡æ— å¥‡çš„ Java å¯¹è±¡) ã€‚

><https://www.infoq.cn/article/fork-join-introduction>
><https://zhuanlan.zhihu.com/p/68554017>



ä¹‹æ‰€ä»¥ç…æœ‰ä»‹äº‹åœ°å–åä¸º POFLCï¼Œæ˜¾ç„¶æ˜¯ä¸ºäº†æ¨¡ä»¿ POJO ã€‚è€Œ POJO â€”â€” Plain Old Java Object è¿™ä¸ªè¯æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œåœ¨ stackoverflow ä¸Šæœ‰ä¸ªå¸–å­è®¨è®ºè¿‡ï¼Œæ‘˜å½•ä¸€ä¸‹å°±æ˜¯

Iâ€™ve come to the conclusion that people forget about regular Java objects because they havenâ€™t got a fancy name. Thatâ€™s why, while preparing for a talk in 2000, Rebecca Parsons, Josh Mackenzie, and I gave them one: POJOs (plain old Java objects).

æˆ‘å¾—å‡ºä¸€ä¸ªç»“è®ºï¼šäººä»¬ä¹‹æ‰€ä»¥æ€»æ˜¯å¿˜è®°ä½¿ç”¨æ ‡å‡†çš„ Java å¯¹è±¡æ˜¯å› ä¸ºç¼ºå°‘ä¸€ä¸ªè¶³å¤Ÿè£…é€¼çš„åå­—ï¼ˆè¯‘æ³¨ï¼šç±»ä¼¼äº Java Bean è¿™æ ·çš„åå­—ï¼‰ã€‚å› æ­¤ï¼Œåœ¨å‡†å¤‡2000å¹´çš„æ¼”è®²æ—¶ï¼ŒRebecca Parsonsï¼ŒJosh Mackenzie å’Œæˆ‘ç»™ä»–ä»¬èµ·äº†ä¸€ä¸ªåå­—å«åš POJO ï¼ˆå¹³æ·¡æ— å¥‡çš„ Java å¯¹è±¡ï¼‰ã€‚

<https://stackoverflow.com/questions/3326319/what-is-meaning-of-plain-old-java-object-pojo>
