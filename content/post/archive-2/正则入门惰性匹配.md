---
title: 正则, 惰性匹配 .*?
author: "-"
date: 2015-09-24T10:21:11+00:00
url: /?p=8351
categories:
  - Uncategorized

tags:
  - reprint
---
## 正则, 惰性匹配 .*?
>http://www.nowamagic.net/librarys/veda/detail/1038

#### 惰性匹配(lazy)

它会匹配尽可能少的字符,它从第一个字符开始找起,一旦符合条件,立刻保存到匹配集合中,然后继续进行查找。所以说它是懒惰的。

还是这个例子: 

nowamagic.net is a good website to learn IT skills</c>.


  
    
      
        
          
            1
          
          
          
            .*
          
        
      
  

#### 效果演示


  nowamagic.net is a good website to learn IT skills.

<input type="button" value=" 正则匹配 " />

#### 本例代码


  
    
      
        
          
            1
          
          
          
            function reg_replace()
          
        
      
    
    
    
      
        
          
            2
          
          
          
            {
          
        
      
    
    
    
      
        
          
            3
          
          
          
                var test = document.getElementById("test");
          
        
      
    
    
    
      
        
          
            4
          
          
          
                aim = ".* ";
          
        
      
    
    
    
      
        
          
            5
          
          
          
                var regex = new RegExp("("+aim+")","g");
          
        
      
    
    
    
      
        
          
            6
          
          
          
            $1");
          
        
      
    
    
    
      
        
          
            7
          
          
          
            }
          
        
      
  

这样匹配显然不是我们的初衷,它仅找到了一个匹配,而通常情况下,我们希望得到的是good 和 learn 两个匹配。

解决的办法,就是上面说到的惰性匹配,它的语法如下表所示: 


  
    
      贪婪匹配
    
    
    
      惰性匹配
    
    
    
      匹配描述
    
  
  
  
    
      ?
    
    
    
      ??
    
    
    
      匹配 0 个或 1 个
    
  
  
  
    
      +
    
    
    
      +?
    
    
    
      匹配 1 个或多个
    
  
  
  
    
      *
    
    
    
      *?
    
    
    
      匹配 0 个或多个
    
  
  
  
    
      {n}
    
    
    
      {n}?
    
    
    
      匹配 n 个
    
  
  
  
    
      {n,m}
    
    
    
      {n,m}?
    
    
    
      匹配 n 个或 m 个
    
  
  
  
    
      {n,}
    
    
    
      {n,}?
    
    
    
      匹配 n 个或多个
    
  


对于本例,当我们再使用惰性匹配。


  
    
      
        
          
            1
          
          
          
            .*?
          
        
      
  

#### 效果演示


  nowamagic.net is a good website to learn IT skills.

<input type="button" value=" 正则匹配 " />

#### 惰性匹配的匹配过程


  
    
      
        
          
            01
          
          
          
            n   // 不匹配,继续
          
        
      
    
    
    
      
        
          
            02
          
          
          
            no  // 不匹配,继续
          
        
      
    
    
    
      
        
          
            03
          
          
          
            ...  // 中间略
          
        
      
    
    
    
      
        
          
            04
          
          
          
            "background-color:orange"><    // 找到可能匹配的字符,继续
          
        
      
    
    
    
      
        
          
            05
          
          
          
            "background-color:orange"><b   // 找到可能匹配的字符,继续
          
        
      
    
    
    
      
        
          
            06
          
          
          
            ...  // 中间略
          
        
      
    
    
    
      
        
          
            07
          
          
          
            //找到匹配,保存到结果集中,继续进行剩下的文本。
          
        
      
    
    
    
      
        
          
            08
          
          
          
            "background-color:orange">good website to learn IT skills</c>.
          
        
      
    
    
    
      
        
          
            09
          
          
          
            w   // 不匹配,继续
          
        
      
    
    
    
      
        
          
            10
          
          
          
            we  // 不匹配,继续
          
        
      
    
    
    
      
        
          
            11
          
          
          
            "background-color:orange"><        // 找到可能的匹配,继续  
          
        
      
    
    
    
      
        
          
            12
          
          
          
            "background-color:orange"><b   // 找到可能的匹配,继续
          
        
      
    
    
    
      
        
          
            13
          
          
          
            ...  // 中间略
          
        
      
    
    
    
      
        
          
            14
          
          
          
            //找到匹配,保存到结果集中,继续进行剩下的文本。
          
        
      
    
    
    
      
        
          
            15
          
          
          
            "background-color:orange">learn
          
        
      
    
    
    
      
        
          
            16
          
          
          
            I   //不匹配,继续
          
        
      
    
    
    
      
        
          
            17
          
          
          
            IT  //不匹配,继续
          
        
      
    
    
    
      
        
          
            18
          
          
          
            "background-color:orange"><    // 找到可能的匹配,继续
          
        
      
    
    
    
      
        
          
            19
          
          
          
            "background-color:orange"><b   // 找到可能的匹配,继续
          
        
      
    
    
    
      
        
          
            20
          
          
          
            ...  // 中间略
          
        
      
    
    
    
      
        
          
            21
          
          
          
            "background-color:orange">skills</c>.  // 匹配失败,继续找
          
        
      
    
    
    
      
        
          
            22
          
          
          
            IT skills</c>.   // 不匹配,继续
          
        
      
    
    
    
      
        
          
            23
          
          
          
            // 字符串结束,匹配结束。一共找到了两个匹配good和learn
          
        
      
    
    
    
      
        
          
            24
          
          
          
            IT skills</c>.
          
        
      
  

我们回顾一下上面 "\d{1,3}" 匹配数字的例子,对于"1234",当我们使用"\d{1,3}"时,进行的是贪婪匹配,它首先找到"123"(因为"1234"不符合),之后的"4"也符合,所以,找到的匹配是"123"和"4"。

当我们使用"\d{1,3}?"匹配上面的例子,对于"1234",这次是惰性匹配。首先,发现"1"符合,将"1"保存到匹配集合中；随后,依次发现"2"、"3"、"4"符合,并依次保存到结果集中,最后,我们得到了四个匹配"1"、"2"、"3"、"4"。