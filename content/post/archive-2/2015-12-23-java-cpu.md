---
title: Java cpu占用调查
author: wiloon
type: post
date: 2015-12-23T01:44:52+00:00
url: /?p=8587
categories:
  - Uncategorized

---
  1. jps 获取Java进程的PID。

```bash
jcmd -l
```

<ol start="2">
  <li>
    导出CPU占用高进程的线程栈。
  </li>
</ol>

```bash
jstack <PID> stack.txt
# 或
jcmd <PID> Thread.print >> stack.txt
```

<ol start="3">
  <li>
    查看对应进程的哪个线程占用CPU过高.
  </li>
</ol>

```bash
top -H -p <PID>
ps -mp <PID> -o THREAD,tid,time | sort -rn | head -n 10
```

<ol start="4">
  <li>
    将线程的PID转换为16进制。
  </li>
</ol>

```bash
echo "obase=16; PID" | bc
printf "%x\n" 73658
```

<ol start="5">
  <li>
    在第二步导出的 stack.txt 中查找转换成为16进制的线程PID。找到对应的线程栈。
  </li>
  <li>
    分析负载高的线程栈都是什么业务操作。优化程序并处理问题。
  </li>
</ol>

SystemTap，LatencyTOP，vmstat, sar, iostat, top, tcpdump
  
iftop, iptraf, ntop, tcpdump
  
Java的JProfiler/TPTP/CodePro Profiler

<blockquote class="wp-embedded-content" data-secret="sGuaIXdcl5">
  
    <a href="https://coolshell.cn/articles/7490.html">性能调优攻略</a>
  
</blockquote>

https://coolshell.cn/articles/7490.html/embed#?secret=sGuaIXdcl5
  
<https://www.linuxhot.com/java-cpu-used-high.html>
  
<https://linux.cn/article-5633-1.html>